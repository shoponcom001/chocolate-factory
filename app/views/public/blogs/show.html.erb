<div class="card w-50 mx-auto mt-4 shadow-lg">
  <%= attachment_image_tag @blog, :image, class:"card-img-top"; %>
    <div class="card-body">
      <div class="card mb-3">
        <div class="card-body">
          <h5 class="card-title"><%= @blog.title %></h5>
          <p class="card-text"><%= @blog.body %></p>
          <p class="card-text">
            <small class="text-muted">
              <%= @blog.created_at.strftime('%Y/%m/%d') %>
              <i class="far fa-comment"><%= @blog.blog_comments.count %></i>
              <i class="far fa-heart"><%= @blog.likes.count %></i>
              <% if current_user %>
              <p>
                <% if current_user.already_liked?(@blog) %>
                  <%= link_to blog_likes_path(@blog), method: :delete do %>
                  <i class="fas fa-heart"></i>
                  <% end %>
                <% else %>
                  <%= link_to blog_likes_path(@blog), method: :post do %>
                  <i class="fas fa-heart text-danger"></i>
                  <% end %>
                <% end %>
              </p>
              <% end %>
            </small>
          </p>
        </div>
      </div>
    </div>
</div>

<div class="card w-50 mx-auto mt-4 shadow-lg">
  <% @blog.blog_comments.each do |blog_comment| %>
    <div class="card-body">
      <div class="card mb-3">
        <div class="card-body">
          <p class="card-text"><%= blog_comment.user.name %></p>
          <p class="card-text"><%= blog_comment.comment %></p>
          <p class="card-text"><small class="text-muted">
            <%= blog_comment.created_at.strftime("%Y/%m/%d") %>
            <% if current_user == blog_comment.user %>
              <%= link_to "  削除", blog_blog_comment_path(blog_comment.blog, blog_comment), method: :delete %>
            <% end %>
          </small></p>
        </div>
      </div>
    </div>
  <% end %>
</div>

<% if current_user %>
  <div class="card w-50 mx-auto mt-4 shadow-lg">
    <%= form_with model: [@blog, @blog_comment], local: true do |f| %>
      <div class="card-body">
        <div class="card mb-3">
          <div class="card-body">
            <div><%= f.text_area :comment, class: "form-control", rows: "3" %></div>
            <div class="text-center"><%= f.submit "コメント", class: "btn btn-success" %></div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% end %>
